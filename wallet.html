<!DOCTYPE HTML>
<html>
	<head>
		<title>Energy Mark</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">
		<div id="page-wrapper">

			<!-- Header -->
			<header id="header">
				<h1><a href="index.html" style="text-decoration: none !important;"><img src="images/logo.png" alt="" width="130" height="48" class="d-inline-block align-text-top"></a></h1>
				<nav id="nav">
					<ul>
						<li><a href="index.html" >Home</a></li>
						<li>
							<a href="manage_farmers.html" class="icon solid fa-angle-down">Energy Farmers</a>
							<ul>
								<li><a href="manage_farmers.html">Manage Energy Farmers</a></li>
								<li><a href="energy_catalog.html">Manage Energy Catalog</a></li>
							</ul>
						</li>
						<li class="active">
							<a href="wallet.html" class="icon solid fa-angle-down">Energy Marketplace</a>
							<ul>
								<li ><a href="wallet.html">Energy Wallet</a></li>
								<li><a href="nft_view.html">Energy NFT Contracts</a></li>
							</ul>
						</li>
						<li>
							<a href="manage_consumers.html">Energy Buyers</a>
						</li>
						<li>
							<a href="contact.html">Contact us</a>
						</li>
					</ul>
				</nav>
			</header>


			<!-- Main -->
				<section id="main" class="container medium">
					<header>
						<h2>Energy Marketplace Wallet Balance</h2>
					</header>
					<div class="box">
						<div id="walletBalance" style = "text-align: center;">
							<h3><b>Energy Mark</b> maintains a central wallet for Buyer payments and Farmer disbursements. <br/>The Available Balance in the Wallet at address <a href = "https://mumbai.polygonscan.com/address/0x243759bf4bdbacc5f30bf6956625c7a3201c33c4" target="_blank"> 0x243759bf4bdbacc5f30bf6956625c7a3201c33c4</a></h3>
							<h2 id = "balance">Please wait... Loading balance </h2>
							<button class = "button alt" onclick="showTransaction()"> See Energy Transactions</button>
						</div>
					</div>
				</section>

			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
						<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
						<li><a href="#" class="icon brands fa-google-plus"><span class="label">Google+</span></a></li>
					</ul>
					<ul class="copyright">
						<li>&copy; Energy Mark. All rights reserved.</li>
					</ul>
				</footer>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script type="text/javascript">
				showTransaction = () =>{
					url_string = "https://mumbai.polygonscan.com/address/0x243759bf4bdbacc5f30bf6956625c7a3201c33c4"
					alert("You will redirected to another tab to view transactions")
					window.open(url_string,'_blank')
				}
				document.addEventListener("DOMContentLoaded", _ =>{
					var paramsObj = {}
					paramsObj.type = "EnergyMarketplace";
					paramsObj.address = "0x12C1dBe2336F70287BA1a83E1e852f80AAf553be";
					paramsObj.queryType = "balance";
					paramsObj.record = {};
					let url = "https://chart-api-6httuqd2wq-uc.a.run.app?dbParams=" + JSON.stringify(paramsObj)
					fetch(url)
					.then(response=>response.json())
					.then(data=>{
						console.log(data)
						$('#balance').html("<h2 style='display:inline'><b>"+data.balance +"</b></h2><h4 style='display:inline;'> MATIC</h4>");
					});
				})
			</script>

	</body>
</html>